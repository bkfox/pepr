{% extends "pepr/ui/site.html" %}
{% load i18n pepr_ui %}

{% block header %}
<p-resource ref="subscription"
            endpoint="{% url "subscription-list" %}"
            id="{{ role.subscription.pk }}">
</p-resource>
<div class="row p-2">
    {% block header-title %}
    <div class="col">
        <h2>
            {{ context.title }}
        </h2>
        <div class="description lead">
            {{ context.description }}
        </div>
    </div>
    {% endblock %}
</div>
<div class="row">
    {% block header-bottom %}
    <div class="col">

    </div>
    <div class="col text-right p-2">
        <p-subscription-info id="container-subscription-info" :subscription="subscription"
            v-if="subscription"></p-subscription-info>

        <template v-if="role && !role.is_anonymous">
            <p-action title="{% trans "Subscribe" %}" icon="fa-users"
                class="btn btn-sm btn-primary"
                action="resource:save"
                :path="subscriptionEndpoint"
                :data="{context: '{{ context.pk }}', access: {{ context.subscription_default_access }}, role: {{ context.subscription_default_role }} }"
                v-if="!role.subscription">
            </p-action>
            <b-button id="container-subscribed-button"
                class="btn btn-sm btn-secondary"
                v-b-modal.container-subscription-info
                v-else>
                <span class="fa fa-users"></span>
                {% trans "Subscription" %}
            </b-button>
        </template>


        {% slot view "container-settings-menu" object=context icon="fa-cog fas" right=True toggle_class="btn btn-secondary" %}
    </div>
    {% endblock %}
</div>
{% endblock %}

{% block main %}
<div class="row">
    {% if context %}
    {% slot view "container-sidebar" object=context service=service %}
    {% endif %}

    <div class="col-10">
    {% block app %}
        {% if object %}
            {% component object %}
        {% else %}
            <div class="alert alert-warning" role="alert">
            {% trans "nothing here" %}
            </div>
        {% endif %}
    {% endblock app %}
    </div>
{% endblock %}

